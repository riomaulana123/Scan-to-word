<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart OCR Lens - Fast</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

<style>
body{
  font-family:system-ui,Arial;
  background:#eef3f9;
  margin:0;padding:12px
}
.container{max-width:720px;margin:auto}
.card{
  background:#fff;
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 8px 20px rgba(0,0,0,.08)
}
h1{text-align:center}
button{
  width:100%;padding:12px;
  border:none;border-radius:10px;
  margin-top:8px;font-weight:600
}
.scan{background:#0d6efd;color:#fff}
.area{background:#198754;color:#fff}
.reset{background:#adb5bd}
#status{text-align:center;font-size:14px;margin-top:6px}
#editor{height:260px}
#image{width:100%;border-radius:10px}
</style>
</head>

<body>
<div class="container">

<h1>‚ö° Smart OCR Lens (FAST)</h1>

<div class="card">
  <input type="file" accept="image/*" id="imageInput">
</div>

<div class="card">
  <img id="image">
</div>

<div class="card">
  <button class="scan" onclick="scanFast()">‚ö° Scan Cepat (Semua)</button>
  <button class="reset" onclick="resetAll()">‚ôªÔ∏è Reset</button>
  <div id="status">‚è≥ OCR siap‚Ä¶</div>
</div>

<div class="card">
  <div id="editor"></div>
</div>

</div>

<script>
const img=document.getElementById("image");
const statusText=document.getElementById("status");
const quill=new Quill('#editor',{theme:'snow'});
let workerReady=false;

imageInput.onchange=e=>{
  img.src=URL.createObjectURL(e.target.files[0]);
  statusText.innerText="üì∑ Gambar dimuat";
};

/* üî• RESIZE SUPER CEPAT */
function resizeFast(){
  const maxW=900;
  const scale=Math.min(1,maxW/img.naturalWidth);
  const c=document.createElement("canvas");
  c.width=img.naturalWidth*scale;
  c.height=img.naturalHeight*scale;
  c.getContext("2d").drawImage(img,0,0,c.width,c.height);
  return c;
}

/* üî• INIT OCR SEKALI */
async function initOCR(){
  if(workerReady) return;
  statusText.innerText="ü§ñ Menyiapkan OCR‚Ä¶";
  window.worker=await Tesseract.createWorker();
  await worker.loadLanguage("ind+eng");
  await worker.initialize("ind+eng");
  await worker.setParameters({
    tessedit_ocr_engine_mode: 0,
    preserve_interword_spaces: 1
  });
  workerReady=true;
  statusText.innerText="‚úÖ OCR siap";
}

/* ‚ö° OCR PALING CEPAT */
async function scanFast(){
  if(!img.src) return alert("Upload gambar dulu");
  await initOCR();

  statusText.innerText="‚ö° Scan cepat berjalan‚Ä¶";

  const canvas=resizeFast();

  const { data } = await worker.recognize(canvas,{
    tessedit_pageseg_mode:6
  });

  quill.setText(data.text);
  statusText.innerText="‚úÖ Scan selesai (FAST)";
}

function resetAll(){
  quill.setText("");
  statusText.innerText="‚ôªÔ∏è Reset selesai";
}
</script>

</body>
</html>
